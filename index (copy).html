<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Big Boxing Rec — Sign Up</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#ef4444; --muted:#9aa4b2;
      --glass: rgba(255,255,255,0.03);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; background:
      radial-gradient(1200px 600px at 10% 10%, rgba(239,68,68,0.08), transparent 8%),
      linear-gradient(180deg, #071028 0%, #051027 100%), color: #e6eef6;
      font-size:16px;
      -webkit-font-smoothing:antialiased;
    }
    .container{max-width:980px; margin:36px auto; padding:20px;}
    header{
      display:flex; align-items:center; gap:16px; margin-bottom:18px;
    }
    .logo{
      width:72px; height:72px; background:linear-gradient(135deg,#ef4444,#f97316);
      display:flex; align-items:center; justify-content:center; border-radius:12px;
      font-weight:800; font-family: 'Orbitron', sans-serif; font-size:22px; color:white;
      box-shadow:0 8px 30px rgba(0,0,0,0.6);
    }
    h1{margin:0; font-size:20px}
    p.lead{margin:4px 0 0; color:var(--muted); font-size:13px}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px; padding:18px; box-shadow: 0 6px 20px rgba(2,6,23,0.6);
      border:1px solid rgba(255,255,255,0.02);
    }
    form .row{display:grid; grid-template-columns: 1fr 1fr; gap:12px; margin-bottom:12px;}
    label{display:block; font-size:13px; margin-bottom:6px; color:#e6eef6}
    input[type="text"], input[type="url"], input[type="number"], textarea{
      width:100%; padding:10px 12px; border-radius:8px; background:var(--glass); border:1px solid rgba(255,255,255,0.04);
      color: #e6eef6;
    }
    textarea{min-height:72px; resize:vertical}
    .videos{display:grid; gap:12px; margin-bottom:14px}
    .video-card{display:flex; gap:12px; align-items:flex-start; background: rgba(255,255,255,0.02); padding:12px; border-radius:10px}
    .video-card .preview{width:160px; height:90px; background:#021019; border-radius:8px; display:flex; align-items:center; justify-content:center; overflow:hidden}
    .video-meta{flex:1}
    .small{font-size:13px; color:var(--muted)}
    .actions{display:flex; gap:8px; align-items:center; margin-top:6px}
    button{cursor:pointer; border:0; padding:10px 14px; border-radius:8px; font-weight:600}
    .btn-primary{background:linear-gradient(90deg,#ef4444,#f97316); color:white}
    .btn-ghost{background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted)}
    .status{display:inline-block; padding:6px 10px; border-radius:999px; font-size:13px; font-weight:700}
    .status.pending{background:rgba(255,193,7,0.12); color:#F59E0B}
    .status.approved{background:rgba(16,185,129,0.12); color:#10B981}
    .status.rejected{background:rgba(248,113,113,0.08); color:#F87171}
    .admin-bar{display:flex; justify-content:space-between; align-items:center; gap:12px; margin-top:14px}
    .submissions{margin-top:14px; display:grid; gap:10px}
    .sub{display:flex; gap:12px; align-items:flex-start; padding:10px; border-radius:10px; background:rgba(255,255,255,0.01); border:1px solid rgba(255,255,255,0.02)}
    .sub .info{flex:1}
    .muted{color:var(--muted); font-size:13px}
    footer{margin-top:22px; text-align:center; color:var(--muted); font-size:13px}
    .hint{font-size:12px; color:var(--muted); margin-top:6px}
    @media (max-width:700px){ .row{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">BBR</div>
      <div>
        <h1>Big Boxing Rec — Fighter Sign Up</h1>
        <p class="lead">Submit your fighter profile and 3 fight videos. All submissions require admin review before publishing.</p>
      </div>
    </header>

    <div class="card" id="signupCard">
      <form id="signupForm" autocomplete="off">
        <div class="row">
          <div>
            <label for="name">Full Name *</label>
            <input id="name" name="name" type="text" placeholder="e.g. Juan 'The Hammer' Ruiz" required />
          </div>
          <div>
            <label for="address">Address (Addy) *</label>
            <input id="address" name="address" type="text" placeholder="City, State or gym address" required />
          </div>
        </div>

        <div class="row">
          <div>
            <label for="height">Height (in) *</label>
            <input id="height" name="height" type="number" min="48" max="96" placeholder="e.g. 72" required />
          </div>
          <div>
            <label for="reach">Reach (in) *</label>
            <input id="reach" name="reach" type="number" min="50" max="90" placeholder="e.g. 74" required />
          </div>
        </div>

        <div>
          <label for="record">Record *</label>
          <input id="record" name="record" type="text" placeholder="e.g. 12-2-1 (W-L-D)" required />
        </div>

        <hr style="margin:14px 0; border:none; border-top:1px solid rgba(255,255,255,0.03)">

        <div>
          <label>Fight videos — <span class="small">Provide 3 fight videos. For each: paste a video URL (YouTube/Vimeo) or choose a local file for preview</span></label>
          <div class="videos" id="videosContainer">
            <!-- Video inputs will be injected here -->
          </div>
        </div>

        <div style="display:flex; gap:8px; margin-top:12px; align-items:center">
          <button type="submit" class="btn-primary">Submit for Review</button>
          <button type="button" id="clearBtn" class="btn-ghost">Clear Form</button>
          <div class="hint">After submitting, your entry is marked <strong>Pending review</strong>. Admin must approve it to change status.</div>
        </div>
      </form>

      <div class="admin-bar" style="margin-top:12px">
        <div>
          <button id="adminToggle" class="btn-ghost">Admin Login</button>
        </div>
        <div id="currentStatus" class="muted">Submissions stored locally (browser only)</div>
      </div>

      <div id="adminPanel" style="display:none; margin-top:12px">
        <div style="display:flex; gap:8px; align-items:center">
          <input id="adminPwd" type="password" placeholder="Admin password" style="padding:8px 10px; border-radius:8px; background:var(--glass); border:1px solid rgba(255,255,255,0.04); color: #e6eef6;">
          <button id="adminLoginBtn" class="btn-primary">Log In</button>
          <button id="adminLogoutBtn" class="btn-ghost" style="display:none">Logout</button>
        </div>

        <div id="adminTools" style="display:none; margin-top:12px">
          <h3 style="margin:6px 0 10px">Submissions</h3>
          <div class="submissions" id="submissionsList"></div>
        </div>
      </div>

    </div>

    <footer>Big Boxing Rec — demo signup & admin review · works in this browser only</footer>
  </div>

  <script>
    // --- Utility / Storage ---
    const STORAGE_KEY = 'bbr_submissions_v1';
    function loadSubmissions(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); }catch(e){ return [] } }
    function saveSubmissions(list){ localStorage.setItem(STORAGE_KEY, JSON.stringify(list)); }

    // --- build video inputs (3 slots) ---
    const videosContainer = document.getElementById('videosContainer');
    for(let i=0;i<3;i++){
      const idx = i;
      const wrapper = document.createElement('div');
      wrapper.className = 'video-card';
      wrapper.innerHTML = `
        <div class="preview" id="preview-${idx}">No preview</div>
        <div class="video-meta">
          <label class="small">Video ${idx+1} URL</label>
          <input id="videoUrl-${idx}" type="url" placeholder="https://youtube.com/..." />
          <div style="height:8px"></div>
          <label class="small">Or choose local file (mp4/webm) — preview only</label>
          <input id="videoFile-${idx}" type="file" accept="video/*" />
          <div class="actions">
            <button type="button" class="btn-ghost" data-preview="${idx}">Preview</button>
            <span class="small" id="videoHint-${idx}"></span>
          </div>
        </div>
      `;
      videosContainer.appendChild(wrapper);

      // wire preview button
      wrapper.querySelector('[data-preview]').addEventListener('click', ()=> {
        const vidUrl = document.getElementById('videoUrl-'+idx).value.trim();
        const fileInput = document.getElementById('videoFile-'+idx);
        const previewEl = document.getElementById('preview-'+idx);
        previewEl.innerHTML = '';
        if(vidUrl){
          // simple embed for youtube/vimeo, otherwise show link
          if(vidUrl.includes('youtube') || vidUrl.includes('youtu.be')){
            // try to extract id
            const ytIdMatch = vidUrl.match(/(?:v=|youtu\\.be\\/|embed\\/)([A-Za-z0-9_-]{6,})/);
            const id = ytIdMatch ? ytIdMatch[1] : null;
            if(id){
              const iframe = document.createElement('iframe');
              iframe.style.width='100%'; iframe.style.height='100%';
              iframe.src = 'https://www.youtube.com/embed/' + id;
              iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
              iframe.allowFullscreen = true;
              previewEl.appendChild(iframe);
              document.getElementById('videoHint-'+idx).textContent = 'Previewing URL';
              return;
            }
          }
          // fallback: link
          const a = document.createElement('a'); a.href = vidUrl; a.target='_blank'; a.textContent='Open video URL';
          a.style.color='white'; previewEl.appendChild(a);
          document.getElementById('videoHint-'+idx).textContent = 'URL provided';
          return;
        }
        if(fileInput.files && fileInput.files[0]){
          const file = fileInput.files[0];
          const v = document.createElement('video');
          v.controls = true; v.style.maxWidth='100%'; v.style.maxHeight='100%';
          const blobUrl = URL.createObjectURL(file);
          v.src = blobUrl;
          previewEl.appendChild(v);
          document.getElementById('videoHint-'+idx).textContent = file.name;
          return;
        }
        previewEl.textContent = 'No preview';
        document.getElementById('videoHint-'+idx).textContent = '';
      });
    }

    // --- Form handling ---
    const form = document.getElementById('signupForm');
    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      // collect fields
      const name = document.getElementById('name').value.trim();
      const address = document.getElementById('address').value.trim();
      const height = document.getElementById('height').value.trim();
      const reach = document.getElementById('reach').value.trim();
      const record = document.getElementById('record').value.trim();

      if(!name || !address || !height || !reach || !record){ alert('Please fill required fields.'); return; }

      const videos = [];
      for(let i=0;i<3;i++){
        const url = document.getElementById('videoUrl-'+i).value.trim();
        const fileInput = document.getElementById('videoFile-'+i);
        if(!url && (!fileInput.files || !fileInput.files[0])){
          alert('Please provide 3 videos (each either a URL or a local file).');
          return;
        }
        // store minimal data: if URL present, store URL; if file present, store file name (objectURL used only for preview)
        if(url){
          videos.push({type:'url', value:url});
        } else {
          videos.push({type:'file', value: fileInput.files[0].name});
        }
      }

      // create submission
      const subs = loadSubmissions();
      const id = 'sub_' + Date.now() + '_' + Math.floor(Math.random()*9000);
      const submission = {
        id, name, address, height, reach, record,
        videos,
        createdAt: new Date().toISOString(),
        status: 'pending', // pending | approved | rejected
        adminNote: ''
      };
      subs.unshift(submission);
      saveSubmissions(subs);
      alert('Submission received — status: Pending review.');
      form.reset();
      // clear previews
      for(let i=0;i<3;i++){ const p = document.getElementById('preview-'+i); p.innerHTML='No preview'; document.getElementById('videoHint-'+i).textContent=''; }
      renderSubmissionsIfAdmin();
    });

    document.getElementById('clearBtn').addEventListener('click', ()=> { if(confirm('Clear form?')) form.reset(); for(let i=0;i<3;i++){ document.getElementById('preview-'+i).innerHTML='No preview'; document.getElementById('videoHint-'+i).textContent=''; } });

    // --- Admin login & UI ---
    const adminToggle = document.getElementById('adminToggle');
    const adminPanel = document.getElementById('adminPanel');
    const adminLoginBtn = document.getElementById('adminLoginBtn');
    const adminLogoutBtn = document.getElementById('adminLogoutBtn');
    const adminPwdInput = document.getElementById('adminPwd');
    const adminTools = document.getElementById('adminTools');
    const submissionsList = document.getElementById('submissionsList');
    const currentStatus = document.getElementById('currentStatus');

    // Show/hide admin section
    adminToggle.addEventListener('click', ()=> {
      adminPanel.style.display = adminPanel.style.display === 'none' ? 'block' : 'none';
    });

    function isAdminLogged(){ return sessionStorage.getItem('bbr_admin_logged') === '1'; }

    function setAdminLogged(v){
      if(v) sessionStorage.setItem('bbr_admin_logged','1'); else sessionStorage.removeItem('bbr_admin_logged');
      adminPwdInput.value='';
      adminLogoutBtn.style.display = v ? 'inline-block' : 'none';
      adminLoginBtn.style.display = v ? 'none' : 'inline-block';
      adminTools.style.display = v ? 'block' : 'none';
      if(v) renderSubmissionsIfAdmin();
    }

    // NOTE: client-side demo password (change/remove for production)
    const DEMO_ADMIN_PWD = 'admin123';

    adminLoginBtn.addEventListener('click', ()=>{
      const p = adminPwdInput.value || '';
      if(p === DEMO_ADMIN_PWD){
        setAdminLogged(true);
        alert('Admin logged in (demo).');
      } else {
        alert('Incorrect admin password.');
      }
    });
    adminLogoutBtn.addEventListener('click', ()=> { setAdminLogged(false); });

    // render submissions
    function renderSubmissionsIfAdmin(){
      if(!isAdminLogged()) return;
      const subs = loadSubmissions();
      submissionsList.innerHTML = '';
      if(subs.length === 0){
        submissionsList.innerHTML = '<div class="muted">No submissions yet.</div>';
        return;
      }
      subs.forEach(s => {
        const div = document.createElement('div');
        div.className = 'sub';
        div.innerHTML = `
          <div class="info">
            <div style="display:flex; justify-content:space-between; align-items:center; gap:12px">
              <div>
                <strong>${escapeHtml(s.name)}</strong> <span class="muted">• ${new Date(s.createdAt).toLocaleString()}</span>
                <div class="muted">${escapeHtml(s.address)}</div>
                <div class="muted">Height: ${escapeHtml(s.height)} in · Reach: ${escapeHtml(s.reach)} in · Record: ${escapeHtml(s.record)}</div>
              </div>
              <div style="text-align:right">
                <div class="status ${s.status}">${capitalize(s.status)}</div>
                <div class="muted" style="margin-top:6px">ID: ${s.id}</div>
              </div>
            </div>
            <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap">
              ${s.videos.map((v,idx)=> {
                if(v.type === 'url') return `<a href="${escapeAttr(v.value)}" target="_blank" class="btn-ghost" style="text-decoration:none">${'Video ' + (idx+1)}</a>`;
                return `<button class="btn-ghost" data-file="${idx}" disabled style="opacity:.7">${'Video ' + (idx+1) + ' (local file: ' + escapeHtml(v.value) + ')'}</button>`;
              }).join(' ')}
            </div>
            <div style="margin-top:8px; display:flex; gap:8px; align-items:center">
              <button class="btn-primary" data-action="approve" data-id="${s.id}">Approve</button>
              <button class="btn-ghost" data-action="reject" data-id="${s.id}">Reject</button>
              <button class="btn-ghost" data-action="delete" data-id="${s.id}">Delete</button>
              <input placeholder="Admin note (optional)" style="padding:8px 10px; border-radius:8px; background:var(--glass); border:1px solid rgba(255,255,255,0.04); color:#e6eef6" data-note="${s.id}" />
            </div>
            <div class="muted" style="margin-top:8px">Admin note: <em>${escapeHtml(s.adminNote || '')}</em></div>
          </div>
        `;
        submissionsList.appendChild(div);
      });

      // wire actions
      submissionsList.querySelectorAll('button[data-action]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.getAttribute('data-id');
          const action = btn.getAttribute('data-action');
          const noteInput = submissionsList.querySelector(`input[data-note="${id}"]`);
          const note = noteInput ? noteInput.value.trim() : '';
          handleAdminAction(id, action, note);
        });
      });
    }

    function handleAdminAction(id, action, note){
      let subs = loadSubmissions();
      const idx = subs.findIndex(x=>x.id === id);
      if(idx < 0) { alert('Submission not found'); return; }
      if(action === 'approve') subs[idx].status = 'approved';
      else if(action === 'reject') subs[idx].status = 'rejected';
      else if(action === 'delete') subs.splice(idx,1);
      if(note !== undefined) subs[idx] && (subs[idx].adminNote = note);
      saveSubmissions(subs);
      renderSubmissionsIfAdmin();
    }

    // auto render on load if logged
    if(isAdminLogged()) setAdminLogged(true);

    // some helpers
    function capitalize(s){ return (s||'').charAt(0).toUpperCase() + (s||'').slice(1); }
    function escapeHtml(text){
      if(!text) return '';
      return String(text).replace(/[&<>"']/g, function(m){ return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"})[m]; });
    }
    function escapeAttr(s){ return s ? s.replace(/"/g,'&quot;') : ''; }

    // expose rendering when admin toggles login status
    // periodically update "currentStatus" with counts
    function updateStatusBar(){
      const subs = loadSubmissions();
      const pending = subs.filter(s=>s.status==='pending').length;
      const approved = subs.filter(s=>s.status==='approved').length;
      const rejected = subs.filter(s=>s.status==='rejected').length;
      currentStatus.textContent = `Submissions: ${subs.length} — Pending: ${pending} · Approved: ${approved} · Rejected: ${rejected}`;
    }
    setInterval(updateStatusBar, 1000);
    updateStatusBar();

    // ensure admin panel re-renders when storage changes (helps when multiple tabs)
    window.addEventListener('storage', ()=>{ if(isAdminLogged()) renderSubmissionsIfAdmin(); updateStatusBar(); });

    // small UX: preview on URL blur
    for(let i=0;i<3;i++){
      document.getElementById('videoUrl-'+i).addEventListener('blur', ()=> {
        // automatically click preview for convenience
        const btn = document.querySelector('[data-preview="'+i+'"]') || document.querySelector('[data-preview]');
        if(btn) btn.click();
      });
      // preview local file when chosen
      document.getElementById('videoFile-'+i).addEventListener('change', ()=> {
        const btn = document.querySelector('[data-preview="'+i+'"]');
        if(btn) btn.click();
      });
    }
  </script>
</body>
</html>
